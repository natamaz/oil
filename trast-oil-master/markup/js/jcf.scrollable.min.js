!function(a){a.addModule(function(a,b){"use strict";function c(b){this.options=a.extend({holder:null,vertical:!0,inactiveClass:"jcf-inactive",verticalClass:"jcf-scrollbar-vertical",horizontalClass:"jcf-scrollbar-horizontal",scrollbarStructure:'<div class="jcf-scrollbar"><div class="jcf-scrollbar-dec"></div><div class="jcf-scrollbar-slider"><div class="jcf-scrollbar-handle"></div></div><div class="jcf-scrollbar-inc"></div></div>',btnDecSelector:".jcf-scrollbar-dec",btnIncSelector:".jcf-scrollbar-inc",sliderSelector:".jcf-scrollbar-slider",handleSelector:".jcf-scrollbar-handle",scrollInterval:300,scrollStep:400},b),this.init()}var d={name:"Scrollable",selector:".jcf-scrollable",plugins:{ScrollBar:c},options:{mouseWheelStep:150,handleResize:!0,alwaysShowScrollbars:!1,alwaysPreventMouseWheel:!1,scrollAreaStructure:'<div class="jcf-scrollable-wrapper"></div>'},matchElement:function(a){return a.is(".jcf-scrollable")},init:function(){this.initStructure(),this.attachEvents(),this.rebuildScrollbars()},initStructure:function(){this.doc=a(document),this.win=a(b),this.realElement=a(this.options.element),this.scrollWrapper=a(this.options.scrollAreaStructure).insertAfter(this.realElement),this.scrollWrapper.css("position","relative"),this.realElement.css("overflow","hidden"),this.vBarEdge=0},attachEvents:function(){var a=this;this.vBar=new c({holder:this.scrollWrapper,vertical:!0,onScroll:function(b){a.realElement.scrollTop(b)}}),this.hBar=new c({holder:this.scrollWrapper,vertical:!1,onScroll:function(b){a.realElement.scrollLeft(b)}}),this.realElement.on("scroll",this.onScroll),this.options.handleResize&&this.win.on("resize orientationchange load",this.onResize),this.realElement.on("jcf-mousewheel",this.onMouseWheel),this.realElement.on("jcf-pointerdown",this.onTouchBody)},onScroll:function(){this.redrawScrollbars()},onResize:function(){a(document.activeElement).is(":input")||this.rebuildScrollbars()},onTouchBody:function(a){"touch"===a.pointerType&&(this.touchData={scrollTop:this.realElement.scrollTop(),scrollLeft:this.realElement.scrollLeft(),left:a.pageX,top:a.pageY},this.doc.on({"jcf-pointermove":this.onMoveBody,"jcf-pointerup":this.onReleaseBody}))},onMoveBody:function(a){var b,c,d=this.verticalScrollActive,e=this.horizontalScrollActive;"touch"===a.pointerType&&(b=this.touchData.scrollTop-a.pageY+this.touchData.top,c=this.touchData.scrollLeft-a.pageX+this.touchData.left,this.verticalScrollActive&&(0>b||b>this.vBar.maxValue)&&(d=!1),this.horizontalScrollActive&&(0>c||c>this.hBar.maxValue)&&(e=!1),this.realElement.scrollTop(b),this.realElement.scrollLeft(c),d||e?a.preventDefault():this.onReleaseBody(a))},onReleaseBody:function(a){"touch"===a.pointerType&&(delete this.touchData,this.doc.off({"jcf-pointermove":this.onMoveBody,"jcf-pointerup":this.onReleaseBody}))},onMouseWheel:function(a){var b,c,d,e=this.realElement.scrollTop(),f=this.realElement.scrollLeft(),g=this.realElement.prop("scrollHeight")-this.embeddedDimensions.innerHeight,h=this.realElement.prop("scrollWidth")-this.embeddedDimensions.innerWidth;(this.options.alwaysPreventMouseWheel||(this.verticalScrollActive&&a.deltaY&&(0>=e&&a.deltaY<0||e>=g&&a.deltaY>0||(d=!0)),this.horizontalScrollActive&&a.deltaX&&(0>=f&&a.deltaX<0||f>=h&&a.deltaX>0||(d=!0)),this.verticalScrollActive||this.horizontalScrollActive))&&(d||this.options.alwaysPreventMouseWheel)&&(a.preventDefault(),b=a.deltaX/100*this.options.mouseWheelStep,c=a.deltaY/100*this.options.mouseWheelStep,this.realElement.scrollTop(e+c),this.realElement.scrollLeft(f+b))},setScrollBarEdge:function(a){this.vBarEdge=a||0,this.redrawScrollbars()},saveElementDimensions:function(){return this.savedDimensions={top:this.realElement.width(),left:this.realElement.height()},this},restoreElementDimensions:function(){return this.savedDimensions&&this.realElement.css({width:this.savedDimensions.width,height:this.savedDimensions.height}),this},saveScrollOffsets:function(){return this.savedOffsets={top:this.realElement.scrollTop(),left:this.realElement.scrollLeft()},this},restoreScrollOffsets:function(){return this.savedOffsets&&(this.realElement.scrollTop(this.savedOffsets.top),this.realElement.scrollLeft(this.savedOffsets.left)),this},getContainerDimensions:function(){var a,b,c,d;return this.isModifiedStyles?a={width:this.realElement.innerWidth()+this.vBar.getThickness(),height:this.realElement.innerHeight()+this.hBar.getThickness()}:(this.saveElementDimensions().saveScrollOffsets(),this.realElement.insertAfter(this.scrollWrapper),this.scrollWrapper.detach(),b=this.realElement.prop("style"),d=parseFloat(b.width),c=parseFloat(b.height),this.embeddedDimensions&&d&&c&&(this.isModifiedStyles|=d!==this.embeddedDimensions.width||c!==this.embeddedDimensions.height,this.realElement.css({overflow:"",width:"",height:""})),a={width:this.realElement.outerWidth(),height:this.realElement.outerHeight()},this.scrollWrapper.insertAfter(this.realElement),this.realElement.css("overflow","hidden").prependTo(this.scrollWrapper),this.restoreElementDimensions().restoreScrollOffsets()),a},getEmbeddedDimensions:function(b){var c,d=this.vBar.getThickness(),e=this.hBar.getThickness(),f=this.realElement.outerWidth()-this.realElement.width(),g=this.realElement.outerHeight()-this.realElement.height();return this.options.alwaysShowScrollbars?(this.verticalScrollActive=!0,this.horizontalScrollActive=!0,c={innerWidth:b.width-d,innerHeight:b.height-e}):(this.saveElementDimensions(),this.verticalScrollActive=!1,this.horizontalScrollActive=!1,this.realElement.css({width:b.width-f,height:b.height-g}),this.horizontalScrollActive=this.realElement.prop("scrollWidth")>this.containerDimensions.width,this.verticalScrollActive=this.realElement.prop("scrollHeight")>this.containerDimensions.height,this.restoreElementDimensions(),c={innerWidth:b.width-(this.verticalScrollActive?d:0),innerHeight:b.height-(this.horizontalScrollActive?e:0)}),a.extend(c,{width:c.innerWidth-f,height:c.innerHeight-g}),c},rebuildScrollbars:function(){this.containerDimensions=this.getContainerDimensions(),this.embeddedDimensions=this.getEmbeddedDimensions(this.containerDimensions),this.scrollWrapper.css({width:this.containerDimensions.width,height:this.containerDimensions.height}),this.realElement.css({overflow:"hidden",width:this.embeddedDimensions.width,height:this.embeddedDimensions.height}),this.redrawScrollbars()},redrawScrollbars:function(){var a,b;this.verticalScrollActive?(a=this.vBarEdge?this.containerDimensions.height-this.vBarEdge:this.embeddedDimensions.innerHeight,b=Math.max(this.realElement.prop("offsetHeight"),this.realElement.prop("scrollHeight"))-this.vBarEdge,this.vBar.show().setMaxValue(b-a).setRatio(a/b).setSize(a),this.vBar.setValue(this.realElement.scrollTop())):this.vBar.hide(),this.horizontalScrollActive?(a=this.embeddedDimensions.innerWidth,b=this.realElement.prop("scrollWidth"),b===a&&(this.horizontalScrollActive=!1),this.hBar.show().setMaxValue(b-a).setRatio(a/b).setSize(a),this.hBar.setValue(this.realElement.scrollLeft())):this.hBar.hide();var c="";this.verticalScrollActive&&this.horizontalScrollActive?c="none":this.verticalScrollActive?c="pan-x":this.horizontalScrollActive&&(c="pan-y"),this.realElement.css("touchAction",c)},refresh:function(){this.rebuildScrollbars()},destroy:function(){this.win.off("resize orientationchange load",this.onResize),this.realElement.off({"jcf-mousewheel":this.onMouseWheel,"jcf-pointerdown":this.onTouchBody}),this.doc.off({"jcf-pointermove":this.onMoveBody,"jcf-pointerup":this.onReleaseBody}),this.saveScrollOffsets(),this.vBar.destroy(),this.hBar.destroy(),this.realElement.insertAfter(this.scrollWrapper).css({touchAction:"",overflow:"",width:"",height:""}),this.scrollWrapper.remove(),this.restoreScrollOffsets()}};return a.extend(c.prototype,{init:function(){this.initStructure(),this.attachEvents()},initStructure:function(){this.doc=a(document),this.isVertical=!!this.options.vertical,this.sizeProperty=this.isVertical?"height":"width",this.fullSizeProperty=this.isVertical?"outerHeight":"outerWidth",this.invertedSizeProperty=this.isVertical?"width":"height",this.thicknessMeasureMethod="outer"+this.invertedSizeProperty.charAt(0).toUpperCase()+this.invertedSizeProperty.substr(1),this.offsetProperty=this.isVertical?"top":"left",this.offsetEventProperty=this.isVertical?"pageY":"pageX",this.value=this.options.value||0,this.maxValue=this.options.maxValue||0,this.currentSliderSize=0,this.handleSize=0,this.holder=a(this.options.holder),this.scrollbar=a(this.options.scrollbarStructure).appendTo(this.holder),this.btnDec=this.scrollbar.find(this.options.btnDecSelector),this.btnInc=this.scrollbar.find(this.options.btnIncSelector),this.slider=this.scrollbar.find(this.options.sliderSelector),this.handle=this.slider.find(this.options.handleSelector),this.scrollbar.addClass(this.isVertical?this.options.verticalClass:this.options.horizontalClass).css({touchAction:this.isVertical?"pan-x":"pan-y",position:"absolute"}),this.slider.css({position:"relative"}),this.handle.css({touchAction:"none",position:"absolute"})},attachEvents:function(){this.bindHandlers(),this.handle.on("jcf-pointerdown",this.onHandlePress),this.slider.add(this.btnDec).add(this.btnInc).on("jcf-pointerdown",this.onButtonPress)},onHandlePress:function(a){"mouse"===a.pointerType&&a.button>1||(a.preventDefault(),this.handleDragActive=!0,this.sliderOffset=this.slider.offset()[this.offsetProperty],this.innerHandleOffset=a[this.offsetEventProperty]-this.handle.offset()[this.offsetProperty],this.doc.on("jcf-pointermove",this.onHandleDrag),this.doc.on("jcf-pointerup",this.onHandleRelease))},onHandleDrag:function(a){a.preventDefault(),this.calcOffset=a[this.offsetEventProperty]-this.sliderOffset-this.innerHandleOffset,this.setValue(this.calcOffset/(this.currentSliderSize-this.handleSize)*this.maxValue),this.triggerScrollEvent(this.value)},onHandleRelease:function(){this.handleDragActive=!1,this.doc.off("jcf-pointermove",this.onHandleDrag),this.doc.off("jcf-pointerup",this.onHandleRelease)},onButtonPress:function(a){var b,c;"mouse"===a.pointerType&&a.button>1||(a.preventDefault(),this.handleDragActive||(this.slider.is(a.currentTarget)?(b=this.handle.offset()[this.offsetProperty]>a[this.offsetEventProperty]?-1:1,c=a[this.offsetEventProperty]-this.slider.offset()[this.offsetProperty],this.startPageScrolling(b,c)):(b=this.btnDec.is(a.currentTarget)?-1:1,this.startSmoothScrolling(b)),this.doc.on("jcf-pointerup",this.onButtonRelease)))},onButtonRelease:function(){this.stopPageScrolling(),this.stopSmoothScrolling(),this.doc.off("jcf-pointerup",this.onButtonRelease)},startPageScrolling:function(a,b){var c=this,d=a*c.currentSize,e=function(){var d=c.value/c.maxValue*(c.currentSliderSize-c.handleSize);return a>0?d+c.handleSize>=b:b>=d},f=function(){c.value+=d,c.setValue(c.value),c.triggerScrollEvent(c.value),e()&&clearInterval(c.pageScrollTimer)};this.pageScrollTimer=setInterval(f,this.options.scrollInterval),f()},stopPageScrolling:function(){clearInterval(this.pageScrollTimer)},startSmoothScrolling:function(a){var c,d=this;this.stopSmoothScrolling();var e=b.requestAnimationFrame||function(a){setTimeout(a,16)},f=function(){return Date.now?Date.now():(new Date).getTime()},g=function(){return a>0?d.value>=d.maxValue:d.value<=0},h=function(){var b=(f()-c)/1e3*d.options.scrollStep;d.smoothScrollActive&&(d.value+=b*a,d.setValue(d.value),d.triggerScrollEvent(d.value),g()||(c=f(),e(h)))};d.smoothScrollActive=!0,c=f(),e(h)},stopSmoothScrolling:function(){this.smoothScrollActive=!1},triggerScrollEvent:function(a){this.options.onScroll&&this.options.onScroll(a)},getThickness:function(){return this.scrollbar[this.thicknessMeasureMethod]()},setSize:function(a){var b=this.btnDec[this.fullSizeProperty](),c=this.btnInc[this.fullSizeProperty]();return this.currentSize=a,this.currentSliderSize=a-b-c,this.scrollbar.css(this.sizeProperty,a),this.slider.css(this.sizeProperty,this.currentSliderSize),this.currentSliderSize=this.slider[this.sizeProperty](),this.handleSize=Math.round(this.currentSliderSize*this.ratio),this.handle.css(this.sizeProperty,this.handleSize),this.handleSize=this.handle[this.fullSizeProperty](),this},setRatio:function(a){return this.ratio=a,this},setMaxValue:function(a){return this.maxValue=a,this.setValue(Math.min(this.value,this.maxValue)),this},setValue:function(a){this.value=a,this.value<0?this.value=0:this.value>this.maxValue&&(this.value=this.maxValue),this.refresh()},setPosition:function(a){return this.scrollbar.css(a),this},hide:function(){return this.scrollbar.detach(),this},show:function(){return this.scrollbar.appendTo(this.holder),this},refresh:function(){0===this.value||0===this.maxValue?this.calcOffset=0:this.calcOffset=this.value/this.maxValue*(this.currentSliderSize-this.handleSize),this.handle.css(this.offsetProperty,this.calcOffset),this.btnDec.toggleClass(this.options.inactiveClass,0===this.value),this.btnInc.toggleClass(this.options.inactiveClass,this.value===this.maxValue),this.scrollbar.toggleClass(this.options.inactiveClass,0===this.maxValue)},destroy:function(){this.btnDec.add(this.btnInc).off("jcf-pointerdown",this.onButtonPress),this.handle.off("jcf-pointerdown",this.onHandlePress),this.doc.off("jcf-pointermove",this.onHandleDrag),this.doc.off("jcf-pointerup",this.onHandleRelease),this.doc.off("jcf-pointerup",this.onButtonRelease),this.stopSmoothScrolling(),this.stopPageScrolling(),this.scrollbar.remove()}}),d})}(jcf);